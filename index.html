<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verolepo Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #131314;
            color: #e8eaed;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 24px;
            border-bottom: 1px solid #3c4043;
            background: #131314;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .bot-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: white;
            padding: 2px;
        }

        .bot-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .app-title {
            font-size: 22px;
            font-weight: 400;
            color: #e8eaed;
        }

        .version-badge {
            background: #3c4043;
            color: #9aa0a6;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .icon-button {
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
            color: #9aa0a6;
        }

        .icon-button:hover {
            background: #3c4043;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-area {
            flex: 1;
            overflow-y: auto;
            padding: 0;
            position: relative;
        }

        /* Welcome Screen */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            max-width: 768px;
            margin: 0 auto;
            padding: 32px;
            text-align: center;
        }

        .welcome-title {
            font-size: 56px;
            font-weight: 400;
            margin-bottom: 32px;
            background: linear-gradient(45deg, #4285f4, #34a853, #fbbc04, #ea4335);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-subtitle {
            font-size: 16px;
            color: #9aa0a6;
            margin-bottom: 48px;
        }

        .suggestions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
            width: 100%;
            max-width: 600px;
        }

        .suggestion-card {
            background: #1f1f1f;
            border: 1px solid #3c4043;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }

        .suggestion-card:hover {
            background: #262626;
            border-color: #5f6368;
        }

        .suggestion-title {
            font-size: 16px;
            font-weight: 500;
            color: #e8eaed;
            margin-bottom: 8px;
        }

        .suggestion-desc {
            font-size: 14px;
            color: #9aa0a6;
            line-height: 1.4;
        }

        /* Chat Messages */
        .messages-container {
            max-width: 768px;
            margin: 0 auto;
            padding: 24px;
        }

        .message {
            margin-bottom: 32px;
            display: flex;
            gap: 16px;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.user .message-content {
            background: #1f1f1f;
            border: 1px solid #3c4043;
            max-width: 80%;
        }

        .message.assistant {
            justify-content: flex-start;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: #4285f4;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 500;
            font-size: 14px;
        }

        .message.assistant .message-avatar {
            background: white;
            padding: 2px;
        }

        .message.assistant .message-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .message-content {
            background: transparent;
            border-radius: 18px;
            padding: 16px 20px;
            max-width: 100%;
            font-size: 14px;
            line-height: 1.6;
        }

        /* Input Area */
        .input-area {
            padding: 20px 24px 24px;
            background: #131314;
        }

        .input-container {
            max-width: 768px;
            margin: 0 auto;
            position: relative;
            background: #1f1f1f;
            border: 1px solid #3c4043;
            border-radius: 24px;
            transition: border-color 0.2s;
        }

        .input-container:focus-within {
            border-color: #4285f4;
        }

        .input-wrapper {
            display: flex;
            align-items: flex-end;
            padding: 4px;
            gap: 8px;
        }

        .attachment-button {
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9aa0a6;
            transition: background-color 0.2s;
        }

        .attachment-button:hover {
            background: #3c4043;
        }

        .chat-input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            padding: 12px 8px;
            color: #e8eaed;
            font-size: 16px;
            font-family: inherit;
            resize: none;
            max-height: 200px;
            min-height: 24px;
        }

        .chat-input::placeholder {
            color: #9aa0a6;
        }

        .input-buttons {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .voice-button {
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9aa0a6;
            transition: background-color 0.2s;
        }

        .voice-button:hover {
            background: #3c4043;
        }

        .send-button {
            width: 40px;
            height: 40px;
            border: none;
            background: #4285f4;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.2s;
            opacity: 0;
            transform: scale(0.8);
        }

        .send-button.visible {
            opacity: 1;
            transform: scale(1);
        }

        .send-button:hover {
            background: #3367d6;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 16px 20px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #9aa0a6;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% {
                opacity: 0.3;
                transform: scale(1);
            }
            40% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }
            
            .welcome-title {
                font-size: 36px;
            }
            
            .suggestions-grid {
                grid-template-columns: 1fr;
            }
            
            .input-area {
                padding: 16px;
            }
            
            .messages-container {
                padding: 16px;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #3c4043;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #5f6368;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="logo-container">
                    <div class="bot-avatar">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSJ3aGl0ZSIvPgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MCA2MCkiPgo8ZWxsaXBzZSBjeD0iNjAiIGN5PSI0MCIgcng9IjQwIiByeT0iMjAiIGZpbGw9IiMxMzEzMTQiLz4KPGVsbGlwc2UgY3g9IjEwIiBjeT0iNjAiIHJ4PSI4IiByeT0iNCIgZmlsbD0iIzEzMTMxNCIvPgo8ZWxsaXBzZSBjeD0iMjAiIGN5PSI3MCIgcng9IjYiIHJ5PSIzIiBmaWxsPSIjMTMxMzE0Ii8+CjxlbGxpcHNlIGN4PSIzMCIgY3k9Ijc4IiByeD0iNCIgcnk9IjIiIGZpbGw9IiMxMzEzMTQiLz4KPGV0ZXh0IHg9IjQ1IiBkeT0iNDgiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIj5WRS5MTzwvdGV4dD4KPC9nPgo8L3N2Zz4K" alt="Verolepo">
                    </div>
                    <div class="app-title">Verolepo</div>
                    <div class="version-badge">2.5 Flash</div>
                </div>
            </div>
            <div class="header-right">
                <button class="icon-button" title="Apps">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6,8c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2zM12,20c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2zM6,20c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2zM6,14c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2zM12,14c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2zM16,6c0,1.1 0.9,2 2,2s2,-0.9 2,-2 -0.9,-2 -2,-2 -2,0.9 -2,2zM12,8c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2zM18,14c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2zM18,20c1.1,0 2,-0.9 2,-2s-0.9,-2 -2,-2 -2,0.9 -2,2 0.9,2 2,2z"/>
                    </svg>
                </button>
                <button class="icon-button" title="Account">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,2C13.1,2 14,2.9 14,4C14,5.1 13.1,6 12,6C10.9,6 10,5.1 10,4C10,2.9 10.9,2 12,2ZM21,9V7L15,1H5C3.89,1 3,1.89 3,3V18A2,2 0 0,0 5,20H19A2,2 0 0,0 21,18V9M12,19A6,6 0 0,1 6,13A6,6 0 0,1 12,7A6,6 0 0,1 18,13A6,6 0 0,1 12,19Z"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="chat-area" id="chatArea">
                <div class="welcome-screen" id="welcomeScreen">
                    <h1 class="welcome-title">Ciao Quaradur</h1>
                    <p class="welcome-subtitle">Come posso aiutarti oggi?</p>
                    
                    <div class="suggestions-grid">
                        <div class="suggestion-card" onclick="sendSuggestion('Dimmi cosa sai fare')">
                            <div class="suggestion-title">Dimmi cosa sai fare</div>
                            <div class="suggestion-desc">Scopri le mie capacità e come posso assisterti</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Aiutami a pianificare')">
                            <div class="suggestion-title">Aiutami a pianificare</div>
                            <div class="suggestion-desc">Organizza progetti, attività e obiettivi</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Fai ricerche per me')">
                            <div class="suggestion-title">Fai ricerche per me</div>
                            <div class="suggestion-desc">Trova informazioni e analizza argomenti complessi</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Scrivi contenuti creativi')">
                            <div class="suggestion-title">Scrivi contenuti creativi</div>
                            <div class="suggestion-desc">Crea testi, storie e contenuti originali</div>
                        </div>
                    </div>
                </div>
                
                <div class="messages-container" id="messagesContainer" style="display: none;">
                    <!-- Messages will be added here -->
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="input-area">
            <div class="input-container">
                <div class="input-wrapper">
                    <button class="attachment-button" title="Allega file">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"/>
                        </svg>
                    </button>
                    
                    <textarea 
                        class="chat-input" 
                        id="chatInput" 
                        placeholder="Chiedi a Verolepo"
                        rows="1"
                        onkeydown="handleKeyDown(event)"
                        oninput="handleInput(this)"
                    ></textarea>
                    
                    <div class="input-buttons">
                        <button class="voice-button" title="Messaggio vocale">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"/>
                            </svg>
                        </button>
                        
                        <button class="send-button" id="sendButton" onclick="sendMessage()" title="Invia">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script Botpress -->
    <script src="https://cdn.botpress.cloud/webchat/v1/inject.js"></script>
    <script>
        // Client ID configurato
        const CLIENT_ID = 'eebca33d-d6e6-4c78-a034-ae16230a43f1';
        
        let botpressReady = false;
        let conversationStarted = false;

        // Inizializza Botpress quando lo script è caricato
        window.addEventListener('load', () => {
            if (window.botpressWebChat) {
                initializeBotpress();
            }
        });

        function initializeBotpress() {
            try {
                window.botpressWebChat.init({
                    clientId: CLIENT_ID,
                    hostUrl: 'https://cdn.botpress.cloud/webchat/v1',
                    messagingUrl: 'https://messaging.botpress.cloud',
                    botName: 'Verolepo Assistant',
                    hideWidget: true,
                    theme: 'prism',
                    composerPlaceholder: 'Chiedi a Verolepo',
                });
                
                botpressReady = true;
                console.log('Botpress inizializzato correttamente');
            } catch (error) {
                console.error('Errore nell\'inizializzazione di Botpress:', error);
            }
        }

        function handleInput(textarea) {
            // Auto-resize del textarea
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';
            
            // Mostra/nascondi il pulsante di invio
            const sendButton = document.getElementById('sendButton');
            const hasText = textarea.value.trim().length > 0;
            
            if (hasText) {
                sendButton.classList.add('visible');
            } else {
                sendButton.classList.remove('visible');
            }
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message && botpressReady) {
                startConversation();
                addMessage(message, 'user');
                input.value = '';
                handleInput(input);
                
                showTypingIndicator();
                
                // Simula risposta (sostituisci con vera integrazione Botpress)
                setTimeout(() => {
                    hideTypingIndicator();
                    addMessage(getSimulatedResponse(message), 'assistant');
                }, 1500);
            } else if (!botpressReady) {
                alert('Verolepo si sta ancora caricando. Riprova tra un momento.');
            }
        }

        function sendSuggestion(text) {
            const input = document.getElementById('chatInput');
            input.value = text;
            handleInput(input);
            sendMessage();
        }

        function startConversation() {
            if (!conversationStarted) {
                document.getElementById('welcomeScreen').style.display = 'none';
                document.getElementById('messagesContainer').style.display = 'block';
                conversationStarted = true;
            }
        }

        function addMessage(text, sender) {
            const container = document.getElementById('messagesContainer');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            
            if (sender === 'user') {
                avatar.textContent = 'Q';
            } else {
                avatar.innerHTML = '<img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSJ3aGl0ZSIvPgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MCA2MCkiPgo8ZWxsaXBzZSBjeD0iNjAiIGN5PSI0MCIgcng9IjQwIiByeT0iMjAiIGZpbGw9IiMxMzEzMTQiLz4KPGVsbGlwc2UgY3g9IjEwIiBjeT0iNjAiIHJ4PSI4IiByeT0iNCIgZmlsbD0iIzEzMTMxNCIvPgo8ZWxsaXBzZSBjeD0iMjAiIGN5PSI3MCIgcng9IjYiIHJ5PSIzIiBmaWxsPSIjMTMxMzE0Ii8+CjxlbGxpcHNlIGN4PSIzMCIgY3k9Ijc4IiByeD0iNCIgcnk9IjIiIGZpbGw9IiMxMzEzMTQiLz4KPHR0ZXh0IHg9IjQ1IiBkeT0iNDgiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIj5WRS5MTzwvdGV4dD4KPC9nPgo8L3N2Zz4K" alt="Verolepo">';
            }
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.textContent = text;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            
            container.appendChild(messageDiv);
            
            // Scroll to bottom
            const chatArea = document.getElementById('chatArea');
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function showTypingIndicator() {
            const container = document.getElementById('messagesContainer');
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.innerHTML = '<img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSJ3aGl0ZSIvPgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MCA2MCkiPgo8ZWxsaXBzZSBjeD0iNjAiIGN5PSI0MCIgcng9IjQwIiByeT0iMjAiIGZpbGw9IiMxMzEzMTQiLz4KPGVsbGlwc2UgY3g9IjEwIiBjeT0iNjAiIHJ4PSI4IiByeT0iNCIgZmlsbD0iIzEzMTMxNCIvPgo8ZWxsaXBzZSBjeD0iMjAiIGN5PSI3MCIgcng9IjYiIHJ5PSIzIiB
