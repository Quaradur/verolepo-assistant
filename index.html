<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verolepo Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #0f0f23;
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: #1a1a2e;
            border-right: 1px solid #2a2a3e;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #2a2a3e;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }

        .sidebar-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .new-chat-btn {
            margin: 1rem;
            padding: 0.75rem 1rem;
            background: #2a2a3e;
            border: 1px solid #3a3a4e;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .new-chat-btn:hover {
            background: #3a3a4e;
        }

        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 0 1rem;
        }

        .chat-item {
            padding: 0.75rem;
            margin: 0.25rem 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .chat-item:hover {
            background: #2a2a3e;
            opacity: 1;
        }

        .chat-item.active {
            background: #2a2a3e;
            opacity: 1;
        }

        /* Main Chat Area */
        .main-chat {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #0f0f23;
        }

        .chat-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #2a2a3e;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-title {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .welcome-message {
            text-align: center;
            max-width: 600px;
            margin: auto;
            padding: 2rem;
        }

        .welcome-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            opacity: 0.7;
            margin-bottom: 2rem;
        }

        .suggestions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .suggestion-card {
            background: #1a1a2e;
            border: 1px solid #2a2a3e;
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .suggestion-card:hover {
            background: #2a2a3e;
            border-color: #667eea;
        }

        .suggestion-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .suggestion-desc {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        /* Message Styles */
        .message {
            display: flex;
            gap: 1rem;
            max-width: 800px;
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: #667eea;
        }

        .message.assistant .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .message-content {
            background: #1a1a2e;
            border: 1px solid #2a2a3e;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            max-width: 100%;
        }

        .message.user .message-content {
            background: #667eea;
            border-color: #667eea;
        }

        /* Input Area */
        .input-area {
            padding: 1.5rem;
            border-top: 1px solid #2a2a3e;
        }

        .input-container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .chat-input {
            width: 100%;
            background: #1a1a2e;
            border: 1px solid #2a2a3e;
            border-radius: 12px;
            padding: 1rem 3rem 1rem 1rem;
            color: white;
            font-size: 1rem;
            resize: none;
            outline: none;
            transition: all 0.2s ease;
            min-height: 24px;
            max-height: 120px;
        }

        .chat-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        .send-button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: #667eea;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .send-button:hover {
            background: #5a67d8;
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 0;
                overflow: hidden;
            }
            
            .sidebar.open {
                width: 280px;
            }
            
            .welcome-title {
                font-size: 2rem;
            }
            
            .suggestions {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 1rem;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.5;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">V</div>
                <div class="sidebar-title">Verolepo Assistant</div>
            </div>
            
            <button class="new-chat-btn" onclick="startNewChat()">
                âž• Nuova Conversazione
            </button>
            
            <div class="chat-history">
                <div class="chat-item active">Chat corrente</div>
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="main-chat">
            <div class="chat-header">
                <div class="chat-title">
                    <div class="status-indicator"></div>
                    Verolepo Assistant
                </div>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <h1 class="welcome-title">ðŸ‘‹ Ciao! Sono Verolepo Assistant</h1>
                    <p class="welcome-subtitle">Il tuo assistente virtuale intelligente. Come posso aiutarti oggi?</p>
                    
                    <div class="suggestions">
                        <div class="suggestion-card" onclick="sendSuggestion('Cos\'Ã¨ Verolepo e cosa puÃ² fare?')">
                            <div class="suggestion-title">ðŸ¤– Scopri Verolepo</div>
                            <div class="suggestion-desc">Cos'Ã¨ Verolepo e cosa puÃ² fare?</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Come posso ottimizzare il mio workflow?')">
                            <div class="suggestion-title">âš¡ Ottimizza Workflow</div>
                            <div class="suggestion-desc">Come posso ottimizzare il mio workflow?</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Spiegami un concetto complesso')">
                            <div class="suggestion-title">ðŸ“š Spiegazioni</div>
                            <div class="suggestion-desc">Spiegami un concetto complesso</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Aiutami con un progetto')">
                            <div class="suggestion-title">ðŸŽ¯ Supporto Progetti</div>
                            <div class="suggestion-desc">Aiutami con un progetto</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-area">
                <div class="input-container">
                    <textarea 
                        class="chat-input" 
                        id="chatInput" 
                        placeholder="Scrivi qui il tuo messaggio..."
                        rows="1"
                        onkeydown="handleKeyDown(event)"
                        oninput="autoResize(this)"
                    ></textarea>
                    <button class="send-button" id="sendButton" onclick="sendMessage()">
                        âž¤
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Script Botpress -->
    <script src="https://cdn.botpress.cloud/webchat/v1/inject.js"></script>
    <script>
        // SOSTITUISCI 'YOUR_CLIENT_ID' CON IL TUO CLIENT ID REALE
        const CLIENT_ID = 'YOUR_CLIENT_ID';
        
        let chatInitialized = false;
        let botpressReady = false;

        // Inizializza Botpress quando lo script Ã¨ caricato
        window.addEventListener('load', () => {
            if (window.botpressWebChat) {
                initializeBotpress();
            }
        });

        function initializeBotpress() {
            window.botpressWebChat.init({
                clientId: CLIENT_ID,
                hostUrl: 'https://cdn.botpress.cloud/webchat/v1',
                messagingUrl: 'https://messaging.botpress.cloud',
                botName: 'Verolepo Assistant',
                hideWidget: true, // Nascondiamo il widget di default
                theme: 'prism',
                composerPlaceholder: 'Scrivi qui il tuo messaggio...',
            });
            
            botpressReady = true;
            console.log('Botpress inizializzato correttamente');
        }

        // Funzioni per l'interfaccia
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message && botpressReady) {
                addMessage(message, 'user');
                input.value = '';
                autoResize(input);
                
                // Mostra indicatore di digitazione
                showTypingIndicator();
                
                // Invia messaggio a Botpress
                setTimeout(() => {
                    sendToBotpress(message);
                }, 500);
            } else if (!botpressReady) {
                alert('Verolepo Assistant si sta ancora caricando. Riprova tra un momento.');
            }
        }

        function sendToBotpress(message) {
            if (window.botpressWebChat) {
                // Qui dovresti implementare l'invio del messaggio a Botpress
                // Per ora simuliamo una risposta
                setTimeout(() => {
                    hideTypingIndicator();
                    addMessage(getSimulatedResponse(message), 'assistant');
                }, 1500);
            }
        }

        function getSimulatedResponse(message) {
            const responses = [
                "Ciao! Sono Verolepo Assistant. Grazie per aver usato questa interfaccia personalizzata! Per connettere il vero chatbot, assicurati di aver inserito il tuo Client ID di Botpress.",
                "Questa Ã¨ un'interfaccia di esempio. Una volta configurato correttamente il Client ID, potrai chattare con il vero Verolepo Assistant!",
                "Perfetto! L'interfaccia funziona. Ora sostituisci 'YOUR_CLIENT_ID' nel codice con il tuo vero Client ID di Botpress per attivare il chatbot.",
                "Mi piace questa interfaccia! Ricorda di configurare il Client ID per abilitare le funzionalitÃ  complete di Verolepo Assistant."
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function sendSuggestion(text) {
            const input = document.getElementById('chatInput');
            input.value = text;
            sendMessage();
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const welcomeMessage = messagesContainer.querySelector('.welcome-message');
            
            // Rimuovi il messaggio di benvenuto se esiste
            if (welcomeMessage) {
                welcomeMessage.remove();
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = sender === 'user' ? 'Tu' : 'V';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.textContent = text;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTypingIndicator() {
            const messagesContainer = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = 'V';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.innerHTML = `
                <div class="typing-indicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(content);
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        function startNewChat() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = `
                <div class="welcome-message">
                    <h1 class="welcome-title">ðŸ‘‹ Ciao! Sono Verolepo Assistant</h1>
                    <p class="welcome-subtitle">Il tuo assistente virtuale intelligente. Come posso aiutarti oggi?</p>
                    
                    <div class="suggestions">
                        <div class="suggestion-card" onclick="sendSuggestion('Cos\\'Ã¨ Verolepo e cosa puÃ² fare?')">
                            <div class="suggestion-title">ðŸ¤– Scopri Verolepo</div>
                            <div class="suggestion-desc">Cos'Ã¨ Verolepo e cosa puÃ² fare?</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Come posso ottimizzare il mio workflow?')">
                            <div class="suggestion-title">âš¡ Ottimizza Workflow</div>
                            <div class="suggestion-desc">Come posso ottimizzare il mio workflow?</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Spiegami un concetto complesso')">
                            <div class="suggestion-title">ðŸ“š Spiegazioni</div>
                            <div class="suggestion-desc">Spiegami un concetto complesso</div>
                        </div>
                        
                        <div class="suggestion-card" onclick="sendSuggestion('Aiutami con un progetto')">
                            <div class="suggestion-title">ðŸŽ¯ Supporto Progetti</div>
                            <div class="suggestion-desc">Aiutami con un progetto</div>
                        </div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
